<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="offerBar">
  Get Extra 6% Off on Prepaid <span class="pill">Shop Now</span>
</div>

<header class="header">
  <div class="headerRow container">
    <button class="iconBtn" onclick="history.back()">‚Üê</button>
    <div class="brand">
      <div class="logoDot"></div>
      <div>
        <div style="font-weight:1100">CART</div>
        <div style="font-size:12px;color:#777;font-weight:900;margin-top:-2px">Your selected items</div>
      </div>
    </div>
    <div class="rightIcons">
      <button class="iconBtn" onclick="openMiniCart()">üõí</button>
    </div>
  </div>
</header>

<div class="panel">
  <h2 class="center">üõí Your Cart</h2>
  <p class="muted center">Remove items or proceed to payment</p>
  <div id="cartList" style="display:grid;gap:10px;margin-top:10px;"></div>
  <div class="total" id="total"></div>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;">
    <button class="btn btnPrimary" onclick="goPay()">üí≥ Proceed to Payment</button>
    <a class="btn btnSoft" href="shop.html">‚¨Ö Back to Shop</a>
  </div>
</div>

<script src="js/products.js"></script>
<script src="js/cart.js"></script>
<script src="js/ui.js"></script>
<script>
  const listEl = document.getElementById("cartList");
  const totalEl = document.getElementById("total");

  function renderCart(){
    const items = cartItems();
    if(items.length===0){
      listEl.innerHTML = `
        <div class="panel center">
          <b>Cart is empty</b>
          <div class="muted">Shop se product add karo.</div>
        </div>
      `;
      totalEl.textContent = "Total Amount: ‚Çπ0";
      return;
    }

    listEl.innerHTML = items.map(it=>`
      <div class="panel" style="margin:0;">
        <div style="display:flex;gap:10px;align-items:center;">
          <img src="images/${it.folder}/1.jpg" alt="${it.name}" style="width:78px;height:78px;object-fit:cover;border-radius:14px;border:1px solid rgba(0,0,0,.08)">
          <div style="flex:1">
            <div style="font-weight:1100">${it.name}</div>
            <div class="muted">${money(it.price)} ‚Ä¢ Qty: ${it.qty}</div>
            <div style="display:flex;gap:8px;margin-top:8px;">
              <button class="iconBtn" onclick="decFromCart('${it.id}')" title="Minus">‚àí</button>
              <button class="iconBtn" onclick="addToCart('${it.id}')" title="Plus">+</button>
              <button class="btn btnDanger" style="margin-top:0" onclick="removeItem('${it.id}');renderCart()">‚úñ Remove</button>
            </div>
          </div>
        </div>
      </div>
    `).join("");

    totalEl.textContent = "Total Amount: " + money(cartTotal());
  }

  function goPay(){
    if(cartItems().length===0){ toast("Cart empty"); return; }
    location.href = "payment.html";
  }

  // re-render when cart updates
  const oldAdd = window.addToCart;
  window.addToCart = function(id){ oldAdd(id); renderCart(); }
  const oldDec = window.decFromCart;
  window.decFromCart = function(id){ oldDec(id); renderCart(); }
  const oldRem = window.removeItem;
  window.removeItem = function(id){ oldRem(id); renderCart(); }

  renderCart();
</script>
<script src="js/animate.js"></script>
</body>
</html>
